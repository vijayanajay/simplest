# User Story 4.2: Enhance Risk Management in Live Trading

## Description
As a quantitative trader, I want enhanced risk management features integrated into live trading execution so that I can minimize losses and protect capital based on backtest insights.

## Requirements
- Build on the `BacktestMetrics` model to incorporate risk metrics like max_drawdown_percent and Sharpe ratio into live trade decisions, using thresholds from `config.yaml`.
- Extend the `Trade` model to include dynamic stop-loss and take-profit levels, calculated from strategy parameters in `TradingStrategy`.
- Monitor real-time portfolio exposure and enforce position sizing rules, integrating with live data feeds for `StockDataPoint` updates.
- Log risk events and breaches using the same logging structure as GA evolution for auditability.

## Acceptance Criteria
- Risk controls prevent trades that exceed predefined drawdown limits, with automatic HOLD or SELL signals triggered via `TradingSignal`.
- Validate enhancements by simulating scenarios with historical data, ensuring metrics align with `BacktestMetrics` KPIs.
- Output includes detailed logs of risk interventions, and the system handles edge cases like market volatility spikes without crashing.
- Testing: Unit tests for risk calculation logic and integration tests with live data mocks to verify trade modifications.

## Technical Context
- Implement using libraries like Riskfolio or custom logic, ensuring compatibility with Pydantic models for validation and the database for caching risk-adjusted indicators.
- Integrate with broker APIs via ccxt for real-time order adjustments, and use GA-derived strategies to inform adaptive risk parameters.